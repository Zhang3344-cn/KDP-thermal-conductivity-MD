#模型参数设置
variable temp_s equal '300.00'
units real           
dimension 3
boundary p p p        
atom_style full
neighbor 1 bin
neigh_modify delay 10
timestep 0.1
#读取KDP模型文件
read_data 1.data
 
#使用tersoff力场
pair_style      hybrid/overlay lj96/cut 10.0 coul/long 10.0

bond_style harmonic
angle_style harmonic
kspace_style    pppm 1e-4
# 设置原子电荷
set type 1 charge +0.835
set type 2 charge +0.461
set type 3 charge +0.312
set type 4 charge -0.454
set type 5 charge -0.506

pair_coeff      1 1 lj96/cut 0.2030 3.585        # K-K相互作用
pair_coeff      2 2 lj96/cut 0.1750 4.500        # P-P
pair_coeff      3 3 lj96/cut 0.0091 1.098        # H-H 
pair_coeff      4 4 lj96/cut 0.0385 3.500        # O1-O1
pair_coeff      5 5 lj96/cut 0.0560 3.800        # O2-O2


bond_coeff  1  430.0000     1.6000
bond_coeff  2  500.0000     1.037 

angle_coeff   1   25.0000   109.5000
angle_coeff   2  148.8000     110.5000
pair_coeff  * * coul/long

pair_coeff 4 5 hbond/dipole 17.5 2.5
#热力学信息输出

min_style      cg
minimize      1e-25 1e-25 10000 10000

fix 1 all nve/limit 0.05
run 100000
unfix 1

thermo 10000
thermo_style custom step temp pe ke etotal vol press lx ly lz
#温度初始化
velocity all create 300 98989 dist gaussian

fix 1 all nvt temp 300 300 0.1
#fix 1 all nve/limit 0.05
run 100000
unfix 1

reset_timestep 0

#Green-Kubo公式中需要的数据
variable A equal vol      
variable dt equal 0.1          
variable cor equal 10000         
variable sam equal 10            
variable dum equal ${cor}*${sam} 
#单位转换公式
variable kB equal 0.001987  # kcal/(mol·K) Boltzmann                                                                                               
variable kcal2J equal 4184 # kcal/mol to J/mol                                                                                 
variable A2m equal 1.0e-10      # Angstrom to meter                                                                                           
variable fs2s equal 1.0e-15     # femtoseconds to seconds
variable convert equal ${kcal2J}/(${A2m}*${fs2s})

#计算热流
compute myKE all ke/atom
compute myPE all pe/atom
compute myStress all stress/atom NULL virial
compute flux all heat/flux myKE myPE myStress


#计算Green-Kubo公式系数
variable   scale equal (${dt}*${sam})/(${kB}*${temp_s}^2*$A) 
#计算Green-Kubo公式
variable k11 equal (trap(f_JJ[3])*${scale})*${convert}
variable k22 equal (trap(f_JJ[4])*${scale})*${convert}
variable k33 equal (trap(f_JJ[5])*${scale})*${convert}
variable k_total equal (v_k11+v_k22+v_k33)/3.0

#启动运算
thermo 100000
thermo_style custom step temp press v_k11 v_k22 v_k33 v_k_total 
fix 1 all nve 
run 1000000
#输出热导率
print "***************************************************** "
print " k11 conductivity : ${k11} [W/mK] @ ${temp_s} K"
print " k22 conductivity : ${k22} [W/mK] @ ${temp_s} K"
print " k33 conductivity : ${k33} [W/mK] @ ${temp_s} K"
print " 3D average conductivity: ${k_total} [W/mK] @ ${temp_s} K"
print "*****************************************************"
